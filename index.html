
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="./css/zui.min.css">
	<link rel="stylesheet" type="text/css" href="./css/utils.css">

	<title>RectGraph</title>
	<style type="text/css">
		*{padding :0;margin:0;}
		#Rect
		{
			margin-left:calc((100% - 800px)/2);
		}
		.rect_text{
		    fill:white;
		}
		.rect_text_2
		{
		    fill:rgba(255,255,255,0.75);
		}
        .topInfo
        {
            background: #EEE;
            position: relative;
            height: 50px;
            width: 100px;
            top: 10px;
            left: 50px;
            border-radius: 5px;
            box-shadow: 0px 2px 5px -2px #000;
            overflow: hidden;
        }
        .info
        {
            width:100%;
            height:25px;
            line-height:25px;
            text-align:center;
            color:black;
            text-overflow: clip;
            overflow: hidden;
        }
        .info1
        {
            background: #AAA;
            border-top-right-radius: 4px;
            border-top-left-radius: 4px;
            font-size:12px;
        }
        .info2
        {
            font-size:18px;
        }
        .topInfo .bottom_arrow
        {
            height:10px;
            width:10px;
            display: block;
            border-right: 10px solid transparent;
            border-left:10px solid transparent;
            border-top:10px solid #EEE;
            margin:auto;
        }
	</style>
</head>
<body>

<div class="top">

	<div class="title-1-board sub-top">
		<div id="settings_btn" onclick="left_show()">
			<div class="icon icon-bars icon-2x" style="margin-left:15px;margin-top:10px;"></div>
		</div>
		<div class="title  title-1 color-white">数据可视化</div>
	</div>

</div>

<div class="board">
		<div class="title-1-board">
			<div class="title-icon line-height50 icon icon-align-left icon-2x">
			</div>
			<div class="title  title-1">条形图</div>
		</div>
		<div class="main-board">		
            <div class="expandable">
                <div class="title-2-board expand-top" expand=0 onclick="expand(this)" >
				    <div class="title-icon icon "></div>
				    <div class="title title-2">猫眼2018-03-04 总票房</div>
                </div>
                
                <div class="expand-board"  param=700>
						<!--tiao xin tu-->

                        <div class='topInfo'>
                            <div class='info info1'>2018-03-04</div>
                            <div class='info info2'>MaoYan</div>
                            <div class='bottom_arrow'></div>
                        </div> 
				        <svg id="Rect" height=650 width=800 >
                                      
                        </svg>

                </div>
                <div class="info-board">svg Demo 1</div>
            </div>
        </div>
</div>


<div id="Left_bar" onclick="left_hide()" style="display: none;">
		
	</div>
	<div id="left_bar" style="left: -250px;">
			<div class="left-top title title-1">Menu</div>
			<div id="left_list_box">
			</div>
	</div>
	
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/zui.js"></script>
<script type="text/javascript" src="./js/utils.js"></script>
<script type="text/javascript">
	var json_data = [{"avgSeatView":"10.9%","avgShowView":"10","avgViewBox":"33.2","boxInfo":"1864.00","boxRate":"29.0%","movieId":1206605,"movieName":"绿皮书","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映4天","releaseInfoColor":"#666666 1.00","seatRate":"15.8%","showInfo":"57417","showRate":"18.2%","splitAvgViewBox":"29.9","splitBoxInfo":"1678.95","splitBoxRate":"28.7%","splitSumBoxInfo":"1.20亿","sumBoxInfo":"1.34亿","viewInfo":"56.0","viewInfoV2":"56.0万"},{"avgSeatView":"6.4%","avgShowView":"7","avgViewBox":"37.4","boxInfo":"1710.17","boxRate":"26.6%","movieId":410629,"movieName":"阿丽塔：战斗天使","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映11天","releaseInfoColor":"#666666 1.00","seatRate":"27.0%","showInfo":"74522","showRate":"23.6%","splitAvgViewBox":"34.2","splitBoxInfo":"1561.45","splitBoxRate":"26.6%","splitSumBoxInfo":"7.09亿","sumBoxInfo":"7.76亿","viewInfo":"45.6","viewInfoV2":"45.6万"},{"avgSeatView":"5.6%","avgShowView":"5","avgViewBox":"35.9","boxInfo":"1475.10","boxRate":"22.9%","movieId":247295,"movieName":"驯龙高手3","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映4天","releaseInfoColor":"#666666 1.00","seatRate":"32.4%","showInfo":"90512","showRate":"28.7%","splitAvgViewBox":"32.8","splitBoxInfo":"1349.47","splitBoxRate":"23.0%","splitSumBoxInfo":"2.15亿","sumBoxInfo":"2.35亿","viewInfo":"41.0","viewInfoV2":"41.0万"},{"avgSeatView":"6.6%","avgShowView":"5","avgViewBox":"35.1","boxInfo":"898.49","boxRate":"13.9%","movieId":248906,"movieName":"流浪地球","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"15.4%","showInfo":"52570","showRate":"16.6%","splitAvgViewBox":"32.2","splitBoxInfo":"825.28","splitBoxRate":"14.1%","splitSumBoxInfo":"42.30亿","sumBoxInfo":"45.47亿","viewInfo":"25.5","viewInfoV2":"25.5万"},{"avgSeatView":"6.3%","avgShowView":"4","avgViewBox":"36.3","boxInfo":"212.08","boxRate":"3.3%","movieId":1218091,"movieName":"飞驰人生","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"3.6%","showInfo":"15666","showRate":"4.9%","splitAvgViewBox":"33.4","splitBoxInfo":"195.24","splitBoxRate":"3.3%","splitSumBoxInfo":"15.80亿","sumBoxInfo":"17.02亿","viewInfo":"5.8","viewInfoV2":"5.8万"},{"avgSeatView":"6.2%","avgShowView":"4","avgViewBox":"36.1","boxInfo":"155.98","boxRate":"2.4%","movieId":344869,"movieName":"疯狂的外星人","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"2.9%","showInfo":"12814","showRate":"4.0%","splitAvgViewBox":"33.3","splitBoxInfo":"144.05","splitBoxRate":"2.4%","splitSumBoxInfo":"20.42亿","sumBoxInfo":"21.98亿","viewInfo":"4.3","viewInfoV2":"4.3万"},{"avgSeatView":"7.3%","avgShowView":"4","avgViewBox":"36.0","boxInfo":"22.01","boxRate":"0.3%","movieId":344262,"movieName":"一吻定情","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映19天","releaseInfoColor":"#666666 1.00","seatRate":"0.3%","showInfo":"1735","showRate":"0.5%","splitAvgViewBox":"33.0","splitBoxInfo":"20.21","splitBoxRate":"0.3%","splitSumBoxInfo":"1.59亿","sumBoxInfo":"1.72亿","viewInfo":"0.6","viewInfoV2":"6115"},{"avgSeatView":"5.1%","avgShowView":"3","avgViewBox":"35.5","boxInfo":"20.70","boxRate":"0.3%","movieId":580298,"movieName":"新喜剧之王","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"0.4%","showInfo":"2230","showRate":"0.7%","splitAvgViewBox":"32.9","splitBoxInfo":"19.19","splitBoxRate":"0.3%","splitSumBoxInfo":"5.79亿","sumBoxInfo":"6.22亿","viewInfo":"0.5","viewInfoV2":"5830"},{"avgSeatView":"6.4%","avgShowView":"2","avgViewBox":"33.0","boxInfo":"14.93","boxRate":"0.2%","movieId":1243239,"movieName":"熊出没·原始时代","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"0.6%","showInfo":"2973","showRate":"0.9%","splitAvgViewBox":"30.5","splitBoxInfo":"13.78","splitBoxRate":"0.2%","splitSumBoxInfo":"6.57亿","sumBoxInfo":"7.08亿","viewInfo":"0.4","viewInfoV2":"4515"},{"avgSeatView":"6.5%","avgShowView":"3","avgViewBox":"30.4","boxInfo":"13.07","boxRate":"0.2%","movieId":1214652,"movieName":"朝花夕誓-于离别之朝束起约定之花","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映11天","releaseInfoColor":"#666666 1.00","seatRate":"0.3%","showInfo":"1580","showRate":"0.5%","splitAvgViewBox":"27.1","splitBoxInfo":"11.66","splitBoxRate":"0.1%","splitSumBoxInfo":"1506.4万","sumBoxInfo":"1676.9万","viewInfo":"0.4","viewInfoV2":"4301"},{"avgSeatView":"4.6%","avgShowView":"3","avgViewBox":"27.0","boxInfo":"11.70","boxRate":"0.1%","movieId":1251606,"movieName":"古井凶灵","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映11天","releaseInfoColor":"#666666 1.00","seatRate":"0.3%","showInfo":"1506","showRate":"0.4%","splitAvgViewBox":"24.1","splitBoxInfo":"10.45","splitBoxRate":"0.1%","splitSumBoxInfo":"359.8万","sumBoxInfo":"400.5万","viewInfo":"0.4","viewInfoV2":"4333"},{"avgSeatView":"5.7%","avgShowView":"4","avgViewBox":"29.0","boxInfo":"5.94","boxRate":"<0.1%","movieId":1206836,"movieName":"神探蒲松龄","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"0.1%","showInfo":"542","showRate":"0.1%","splitAvgViewBox":"27.1","splitBoxInfo":"5.55","splitBoxRate":"<0.1%","splitSumBoxInfo":"1.44亿","sumBoxInfo":"1.52亿","viewInfo":"0.2","viewInfoV2":"2048"},{"avgSeatView":"10.7%","avgShowView":"3","avgViewBox":"36.4","boxInfo":"5.02","boxRate":"<0.1%","movieId":1215114,"movieName":"廉政风云","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映28天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"490","showRate":"0.1%","splitAvgViewBox":"34.2","splitBoxInfo":"4.71","splitBoxRate":"<0.1%","splitSumBoxInfo":"1.07亿","sumBoxInfo":"1.13亿","viewInfo":"0.1","viewInfoV2":"1377"},{"avgSeatView":"63.5%","avgShowView":"70","avgViewBox":"32.5","boxInfo":"2.26","boxRate":"<0.1%","movieId":1223430,"movieName":"浴血广昌","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"2018-08","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"10","showRate":"<0.1%","splitAvgViewBox":"30.0","splitBoxInfo":"2.08","splitBoxRate":"<0.1%","splitSumBoxInfo":"9697.0万","sumBoxInfo":"9704.6万","viewInfo":"0.0","viewInfoV2":"696"},{"avgSeatView":"38.7%","avgShowView":"6","avgViewBox":"34.0","boxInfo":"0.74","boxRate":"<0.1%","movieId":1228750,"movieName":"照相师","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映83天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"39","showRate":"<0.1%","splitAvgViewBox":"33.9","splitBoxInfo":"0.73","splitBoxRate":"<0.1%","splitSumBoxInfo":"1064.8万","sumBoxInfo":"1076.9万","viewInfo":"0.0","viewInfoV2":"218"},{"avgSeatView":"2.9%","avgShowView":"2","avgViewBox":"28.0","boxInfo":"0.74","boxRate":"<0.1%","movieId":1256964,"movieName":"逆罪","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映4天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"207","showRate":"<0.1%","splitAvgViewBox":"25.2","splitBoxInfo":"0.66","splitBoxRate":"<0.1%","splitSumBoxInfo":"7.5万","sumBoxInfo":"8.3万","viewInfo":"0.0","viewInfoV2":"264"},{"avgSeatView":"3.5%","avgShowView":"3","avgViewBox":"36.3","boxInfo":"0.58","boxRate":"<0.1%","movieId":1235560,"movieName":"白蛇：缘起","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映53天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"74","showRate":"<0.1%","splitAvgViewBox":"32.4","splitBoxInfo":"0.52","splitBoxRate":"<0.1%","splitSumBoxInfo":"4.11亿","sumBoxInfo":"4.48亿","viewInfo":"0.0","viewInfoV2":"162"},{"avgSeatView":"10.5%","avgShowView":"2","avgViewBox":"31.5","boxInfo":"0.56","boxRate":"<0.1%","movieId":1205582,"movieName":"今夜在浪漫剧场","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映19天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"97","showRate":"<0.1%","splitAvgViewBox":"28.5","splitBoxInfo":"0.50","splitBoxRate":"<0.1%","splitSumBoxInfo":"1107.0万","sumBoxInfo":"1227.0万","viewInfo":"0.0","viewInfoV2":"178"},{"avgSeatView":"6.9%","avgShowView":"9","avgViewBox":"30.7","boxInfo":"0.55","boxRate":"<0.1%","movieId":344757,"movieName":"蓝色生死恋","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"上映19天","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"21","showRate":"<0.1%","splitAvgViewBox":"28.5","splitBoxInfo":"0.51","splitBoxRate":"<0.1%","splitSumBoxInfo":"137.3万","sumBoxInfo":"148.0万","viewInfo":"0.0","viewInfoV2":"182"},{"avgSeatView":"71.2%","avgShowView":"166","avgViewBox":"32.5","boxInfo":"0.53","boxRate":"<0.1%","movieId":78642,"movieName":"我的渡口","myRefundNumInfo":"--","myRefundRateInfo":"--","onlineBoxRate":"--","refundViewInfo":"--","refundViewRate":"--","releaseInfo":"2012-12","releaseInfoColor":"#666666 1.00","seatRate":"<0.1%","showInfo":"1","showRate":"<0.1%","splitAvgViewBox":"30.0","splitBoxInfo":"0.49","splitBoxRate":"<0.1%","splitSumBoxInfo":"23.0万","sumBoxInfo":"23.1万","viewInfo":"0.0","viewInfoV2":"166"}];
	//json数据来自猫眼 2019-3-4
        var rect_box,info_box, svg;
	//存储节点元素---用于直接索引
	   info_box = document.getElementsByClassName('topInfo')[0];
	//直方图描绘函数
		function draw_rect(){
			svg = document.getElementById("Rect");
			var rect ;
			var height;
			var text_ ;
			//画20个直方
			for(var i = 0; i < 20; i ++ ){
				rect = document.createElement("rect");
				svg.appendChild(rect);
				
				var boxoffice = json_data[i]["sumBoxInfo"];//从json_data中获取票房数据
				var boxoffice_num = parseFloat(json_data[i]["sumBoxInfo"].substring(0,boxoffice.length - 1));//票房数据的格式是带单位的（1.1亿/1560万）,对这个数据进行裁剪
				if(boxoffice[boxoffice.length -1] =="亿")boxoffice_num *= 10000;//将以亿结尾的票房乘10000达到以万为单位
				console.log(boxoffice_num);//调试用，控制台输出
				boxoffice_num /= 1000; //降低高度
				height = boxoffice_num;//直方高度
				rect.outerHTML="<rect class='rect' x="+(50 + i* 35)+" y="+(600-height)+" width=34 height="+ height+" fill='rgb(188,208,197)' onmouseover='rect_show_text("+i+")' onmouseout='rect_hidden_text("+i+")' onclick='rect_clicked("+i+")' clicked_=0 />";
                
			}
			rect_box = document.getElementsByClassName("rect");//直方的节点数组
            addX_axis(svg,40,760,600);
            addY_axis(svg,40,0,600);
            addX_Arrow(svg, 760,600);
            addY_Arrow(svg,40, 0);
            addX_scale(svg, 40 + 10 , 600, 20, 700, 'movie');
            addY_scale(svg, 40, 600, 20, 600, "boxOffice/亿", 0.1);
        }
        //在鼠标进入矩形时
        function rect_show_text(i)
        {
            rect_box[i].setAttribute("fill", "rgb(145,191,191)");//调整颜色
            var x = rect_box[i].getAttribute("x");
            var y = rect_box[i].getAttribute("y");
            info_box.setAttribute("style","overflow:unset;");
            info_box.children[0].innerHTML = json_data[i]["movieName"];
            info_box.children[1].innerHTML = json_data[i]["sumBoxInfo"];
            info_box.style.top = y-15+"px";
            info_box.style.left = x-32+"px";
        }
        //在鼠标离开矩形时
        function rect_hidden_text(i)
        {
            rect_box[i].setAttribute("fill", "rgb(188,208,197)");
        }
        //添加x轴
        function addX_axis(svg,x1,x2, y)
        {
            var line = document.createElement("line");
            svg.appendChild(line);
            line.outerHTML="<line x1="+x1+" y1="+y+" x2="+x2+" y2="+y+" style='stroke:white;stroke-width:1px;'></line>"
        }
        //添加y轴
        function addY_axis(svg,x,y1, y2)
        {
            var line = document.createElement("line");
            svg.appendChild(line);
            line.outerHTML="<line x1="+x+" y1="+y1+" x2="+x+" y2="+y2+" style='stroke:white;stroke-width:1px;'></line>"
        }
        //添加Arrow
        function addX_Arrow(svg, x, y)
        {
            var line1 = document.createElement("line");
            var line2 = document.createElement("line");
            svg.appendChild(line1);
            svg.appendChild(line2);
            line1.outerHTML="<line x1="+x+" y1="+y+" x2="+(x-5)+" y2="+(y-2)+" style='stroke:white;stroke-width:1px;'></line>";
            line2.outerHTML="<line x1="+x+" y1="+y+" x2="+(x-5)+" y2="+(y+2)+" style='stroke:white;stroke-width:1px;'></line>";
        }
        function addY_Arrow(svg, x, y)
        {
            var line1 = document.createElement("line");
            var line2 = document.createElement("line");
            svg.appendChild(line1);
            svg.appendChild(line2);
            line1.outerHTML="<line x1="+x+" y1="+y+" x2="+(x-2)+" y2="+(y+5)+" style='stroke:white;stroke-width:1px;'></line>";
            line2.outerHTML="<line x1="+x+" y1="+y+" x2="+(x+2)+" y2="+(y+5)+" style='stroke:white;stroke-width:1px;'></line>";
        }
        function addX_scale(svg, x0, y0, num, width, info="")
        {
            var line;
            var step = parseInt(width/num);
            var offset = parseInt(step/2);
            for(var i = 0; i < num; i++ )
            {
                line = document.createElement("line");
                svg.appendChild(line);
                line.outerHTML="<line x1="+(x0 +step*i + offset)+" y1="+y0+" x2="+( x0 + step*i + offset)+" y2="+(y0+3)+" style='stroke:white;stroke-width:1px;'></line>";
            }
            if(info == "")return;
            var text = document.createElement("text");
            svg.appendChild(text); 
            text.outerHTML = "<text x="+( x0 + step*(num-1) + offset*2)+" y="+(y0 + 20)+" fill='white' > "+info+"</text>";
        }
        function addY_scale(svg, x0, y0, num, height, info="", value)
        {
            var line;
            var step = parseInt(height/num);
            var scale_value = (value)*step;
            var offset = 0;
            for(var i = 0; i < num; i++ )
            {
                line = document.createElement("line");
                svg.appendChild(line);
                line.outerHTML="<line x1="+(x0)+" y1="+( y0 -( step*i + offset )) +" x2="+( x0 - 3)+" y2="+( y0 -( step*i + offset ))+" style='stroke:white;stroke-width:1px;'></line>";
            }
            var text = document.createElement("text");
            svg.appendChild(text); 
            text.outerHTML = "<text x="+(x0 - 30)+" y="+(y0 -( step*(num-1) + offset - 5 ))+" fill='white' > "+scale_value*(num-1)+"</text>";
            if(info == "")return;
            text = document.createElement("text");
            svg.appendChild(text); 
            text.outerHTML = "<text x="+(x0 + 10)+" y="+(y0 -( step*(num-1) + offset*2 ))+" fill='white' > "+info+"</text>";
        }
		window.onload = draw_rect();//此处并没有使用对象，而是用前面的方式
	</script>
</body>
</html>
